import { EnvironmentProviders, ModuleWithProviders, NgModule, Provider } from '@angular/core';
import { NistCpeService } from './services/nist-cpe.service';
import { NIST_BASE_URL } from './tokens/nist-base-url.token';
import { NIST_API_KEY } from './tokens/nist-api-key.token';

@NgModule({
    providers: [
        NistCpeService,
    ],
})
export class NistApiModule {
    public static forRoot(nistConfig?: { nistApiKey?: string; nistBaseUrl?: string }): ModuleWithProviders<NistApiModule> {

        const providers: (Provider | EnvironmentProviders)[] = [
        ];

        if (nistConfig?.nistApiKey) {
            providers.push({
                provide: NIST_API_KEY,
                useValue: nistConfig.nistApiKey,
            });
        }
        if (nistConfig?.nistBaseUrl) {
            providers.push({
                provide: NIST_BASE_URL,
                useValue: nistConfig.nistBaseUrl,
            })
        }

        return {
            ngModule: NistApiModule,
            providers,
        };
    }
}
