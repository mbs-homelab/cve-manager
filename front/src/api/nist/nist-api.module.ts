import { EnvironmentProviders, ModuleWithProviders, NgModule, Provider } from '@angular/core';
import { NistCpeService } from './services/nist-cpe.service';
import { NIST_BASE_URL } from './tokens/nist-base-url.token';
import { NIST_API_KEY } from './tokens/nist-api-key.token';

@NgModule({
    providers: [
        NistCpeService,
    ],
})
export class NistApiModule {
    public static forRoot(apiKey: string, nistBaseUrl?: string): ModuleWithProviders<NistApiModule> {
        if (!apiKey) {
            throw new Error('Missing apiKey in NistApiModule.forRoot');
        }
        const providers: (Provider | EnvironmentProviders)[] = [
            {
                provide: NIST_BASE_URL,
                useValue: nistBaseUrl,
            },
            {
                provide: NIST_API_KEY,
                useValue: apiKey,
            }
        ];

        return {
            ngModule: NistApiModule,
            providers,
        };
    }
}
