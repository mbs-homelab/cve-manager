import { AsyncPipe, NgIf } from '@angular/common';
import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';
import { MatButtonModule } from '@angular/material/button';
import { MatProgressSpinnerModule } from '@angular/material/progress-spinner';
import { MatTableModule } from '@angular/material/table';
import { CpesTableService } from './cpes-table.service';
import { Observable } from 'rxjs';
import { Cpe } from '../../../../api/backend/models/cpe.model';
import { MatIconModule } from '@angular/material/icon';
import { TranslateModule } from '@ngx-translate/core';

@Component({
    selector: 'cve-cpes-table',
    standalone: true,
    templateUrl: './cpes-table.component.html',
    styleUrl: './cpes-table.component.scss',
    changeDetection: ChangeDetectionStrategy.OnPush,
    imports: [
        NgIf,
        AsyncPipe,
        MatTableModule,
        MatProgressSpinnerModule,
        MatButtonModule,
        MatIconModule,
        TranslateModule,
    ],
    providers: [
        CpesTableService
    ],
})
export class CpesTableComponent implements OnInit {
    currentData$: Observable<Cpe[]> = this.cpesTableService.currentData$;

    pending$: Observable<boolean> = this.cpesTableService.pending$;

    displayedColumns: (keyof Cpe | string)[] = ['cpe', 'name', 'notify', 'actions', 'details'];

    constructor(
        private readonly cpesTableService: CpesTableService,
    ) { }

    public ngOnInit(): void {
        this.cpesTableService.loadData();
    }
}
