export type CpeComponent = 'vendor' | 'product' | 'version' | 'subversion';

const cpeComponentNameToIndex: Map<string, number> = new Map(
    [
        ['vendor', 3],
        ['product', 4],
        ['version', 5],
        ['subversion', 6]
    ]
)

export const nistGetComponentFromCpeName =
    (cpeName: string | null | undefined, cpeComponent: CpeComponent, fallbackText: string = '---') => {
        if (!cpeName) {
            return fallbackText;
        }

        const parts: string[] = cpeName.split(':');

        const index: number | undefined = cpeComponentNameToIndex.get(cpeComponent);

        if (!index) {
            return fallbackText;
        }

        if (parts.length <= index + 1) {
            return fallbackText;
        }

        if (parts[index] === '*' || parts[index] === '-') {
            return fallbackText;
        }

        return parts[index];
    }
