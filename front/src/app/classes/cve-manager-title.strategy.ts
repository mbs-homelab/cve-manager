import { inject, Injectable } from '@angular/core';
import { Title } from '@angular/platform-browser';
import { RouterStateSnapshot, TitleStrategy } from '@angular/router';
import { } from 'rxjs';
import { TranslationsService } from '../services/translations.service';

const defaultTitleKey: string = 'page.default-title';

@Injectable()
export class CveManagerTitleStrategy extends TitleStrategy {
    private readonly title: Title = inject(Title);

    private readonly translationsService: TranslationsService = inject(TranslationsService);

    override updateTitle(snapshot: RouterStateSnapshot): void {
        const titleKey: string | undefined =
            this.buildTitle(snapshot);
        if (!titleKey) {
            this.title.setTitle(this.translationsService.getInstantTranslation(defaultTitleKey));
            return;
        }
        this.title.setTitle(this.translationsService.getInstantTranslation(titleKey));
    }
}
